<!DOCTYPE html>  
<html lang="en" data-theme="light">  
<head>  
    <meta charset="utf-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1">  
    <title>ACSM Converter</title>  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">  
    <style>  
        :root {  
            --pico-font-size: 16px;  
            --accent: #4a90d9;  
            --accent-hover: #357abd;  
        }  
        body { background: #f4f6f9; }  
        header.hero {  
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);  
            color: #fff;  
            padding: 2.5rem 0;  
            margin-bottom: 2rem;  
            text-align: center;  
        }  
        header.hero h1 { color: #fff; margin-bottom: 0.25rem; }  
        header.hero p { color: #a0b4cc; margin: 0; }  
        .upload-zone {  
            border: 3px dashed #b0bec5;  
            border-radius: 12px;  
            padding: 3rem 2rem;  
            text-align: center;  
            cursor: pointer;  
            transition: all 0.3s ease;  
            background: #fff;  
            margin-bottom: 2rem;  
        }  
        .upload-zone:hover {  
            border-color: var(--accent);  
            background: #eef4fb;  
        }  
        .upload-zone.dragover {  
            border-color: var(--accent);  
            background: #dbe9f9;  
            transform: scale(1.02);  
            box-shadow: 0 4px 12px rgba(74, 144, 217, 0.2);  
        }  
        .upload-zone .icon { font-size: 3rem; margin-bottom: 1rem; }  
        .upload-zone p { margin: 0.5rem 0; color: #546e7a; font-size: 1.1rem; }  
        .upload-zone .hint { color: #90a4ae; font-size: 0.9rem; margin-top: 0.5rem; }  
        #fileInput { display: none; }  
        .progress-section { display: none; margin: 2rem 0; }  
        .progress-section.show { display: block; }  
        .progress-bar { width: 100%; height: 8px; background: #e0e0e0; border-radius: 4px; overflow: hidden; margin: 1rem 0; }  
        .progress-fill { height: 100%; background: var(--accent); width: 0%; transition: width 0.3s ease; }  
        .result-section { display: none; margin: 2rem 0; padding: 1.5rem; border-radius: 8px; }  
        .result-section.show { display: block; }  
        .result-section.success { background: #e8f5e9; border-left: 4px solid #4caf50; }  
        .result-section.error { background: #ffebee; border-left: 4px solid #f44336; }  
        .result-icon { font-size: 2rem; margin-bottom: 0.5rem; }  
        .result-title { font-size: 1.3rem; font-weight: bold; margin: 0.5rem 0; }  
        .result-message { color: #555; margin: 0.5rem 0; }  
        #downloadContainer {  
            margin-top: 1.5rem;  
            text-align: center;  
        }  
        #downloadContainer button {  
            background-color: var(--accent);  
            color: white;  
            border: none;  
            padding: 0.75rem 1.5rem;  
            font-size: 1rem;  
            border-radius: 6px;  
            cursor: pointer;  
            transition: all 0.3s ease;  
            margin: 0.5rem;  
        }  
        #downloadContainer button:hover {  
            background-color: var(--accent-hover);  
            transform: translateY(-2px);  
            box-shadow: 0 4px 12px rgba(74, 144, 217, 0.3);  
        }  
        .button-group { text-align: center; margin-top: 1rem; }  
        .button-group button { margin: 0.5rem; }  
    </style>  
</head>  
<body>  
    <header class="hero">  
        <h1>ðŸ“š ACSM Converter</h1>  
        <p>Convert Adobe ACSM files to DRM-free PDF</p>  
    </header>  
    <main class="container">  
        <section id="uploadSection" class="upload-zone">  
            <div class="icon">ðŸ“¤</div>  
            <p><strong>Click to upload or drag and drop</strong></p>  
            <p>ACSM files only</p>  
            <p class="hint">Maximum file size: 100MB</p>  
            <input type="file" id="fileInput" accept=".acsm">  
        </section>  
        <section id="progressSection" class="progress-section">  
            <p>Converting your file...</p>  
            <div class="progress-bar">  
                <div id="progressFill" class="progress-fill"></div>  
            </div>  
            <p id="progressText" style="text-align: center; color: #666;">0%</p>  
        </section>  
        <section id="resultSection" class="result-section">  
            <div class="result-icon" id="resultIcon"></div>  
            <div class="result-title" id="resultTitle"></div>  
            <div class="result-message" id="resultMessage"></div>  
            <div id="downloadContainer"></div>  
            <div class="button-group">  
                <button id="resultReset">Convert Another File</button>  
            </div>  
        </section>  
    </main>  
    <script>  
        const uploadZone = document.getElementById('uploadSection');  
        const fileInput = document.getElementById('fileInput');  
        const progressSection = document.getElementById('progressSection');  
        const progressFill = document.getElementById('progressFill');  
        const progressText = document.getElementById('progressText');  
        const resultSection = document.getElementById('resultSection');  
        const resultIcon = document.getElementById('resultIcon');  
        const resultTitle = document.getElementById('resultTitle');  
        const resultMessage = document.getElementById('resultMessage');  
        const downloadContainer = document.getElementById('downloadContainer');  
        const resultReset = document.getElementById('resultReset');  
        uploadZone.addEventListener('click', () => fileInput.click());  
        uploadZone.addEventListener('dragover', (e) => {  
            e.preventDefault();  
            uploadZone.classList.add('dragover');  
        });  
        uploadZone.addEventListener('dragleave', () => {  
            uploadZone.classList.remove('dragover');  
        });  
        uploadZone.addEventListener('drop', (e) => {  
            e.preventDefault();  
            uploadZone.classList.remove('dragover');  
            const files = e.dataTransfer.files;  
            if (files.length > 0) {  
                fileInput.files = files;  
                handleFileSelect();  
            }  
        });  
        fileInput.addEventListener('change', handleFileSelect);  
        function handleFileSelect() {  
            const file = fileInput.files[0];  
            if (!file) return;  
            if (!file.name.endsWith('.acsm')) {  
                showError('Invalid File', 'Please select an ACSM file');  
                return;  
            }  
            uploadFile(file);  
        }  
        function uploadFile(file) {  
            const formData = new FormData();  
            formData.append('file', file);  
            uploadZone.style.display = 'none';  
            progressSection.classList.add('show');  
            resultSection.classList.remove('show', 'success', 'error');  
            const xhr = new XMLHttpRequest();  
            xhr.upload.addEventListener('progress', (e) => {  
                if (e.lengthComputable) {  
                    const percentComplete = (e.loaded / e.total) * 100;  
                    progressFill.style.width = percentComplete + '%';  
                    progressText.textContent = Math.round(percentComplete) + '%';  
                }  
            });  
            xhr.addEventListener('load', () => {  
                if (xhr.status === 200) {  
                    const response = JSON.parse(xhr.responseText);  
                    showSuccess('Conversion Complete', response.message, response.filename);  
                } else {  
                    const response = JSON.parse(xhr.responseText);  
                    showError('Conversion Failed', response.error || 'An error occurred');  
                }  
            });  
            xhr.addEventListener('error', () => {  
                showError('Upload Error', 'Failed to upload file');  
            });  
            xhr.open('POST', '/convert', true);  
            xhr.send(formData);  
        }  
        function showSuccess(title, message, filename) {  
            progressSection.classList.remove('show');  
            resultSection.classList.add('show', 'success');  
            resultIcon.textContent = 'âœ…';  
            resultTitle.textContent = title;  
            resultMessage.textContent = message || `Successfully converted: ${filename}`;  
            downloadContainer.innerHTML = `  
                <button onclick="window.location.href='/download/' + encodeURIComponent('${filename}')">  
                    ðŸ“¥ Download PDF  
                </button>  
            `;  
        }  
        function showError(title, message) {  
            progressSection.classList.remove('show');  
            resultSection.classList.add('show', 'error');  
            resultIcon.textContent = 'âŒ';  
            resultTitle.textContent = title;  
            resultMessage.textContent = message;  
            downloadContainer.innerHTML = '';  
        }  
        resultReset.addEventListener('click', () => {  
            fileInput.value = '';  
            resultSection.classList.remove('show', 'success', 'error');  
            uploadZone.style.display = 'block';  
            progressSection.classList.remove('show');  
        });  
    </script>  
</body>  
</html>  
